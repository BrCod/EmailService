name: 'Tag and Push'
description: 'Creates and pushes a version tag to trigger CD'
inputs:
  version-prefix:
    description: 'Prefix for version tag (e.g., v0.1)'
    required: false
    default: 'v0.1'
runs:
  using: 'composite'
  steps:
    - name: Generate version tag
      id: version
      shell: bash
      run: |
        DATE=$(date +'%Y%m%d')
        SHA=$(echo "${{ github.sha }}" | cut -c1-7)
        VERSION="${{ inputs.version-prefix }}.${DATE}-${SHA}"
        echo "version=$VERSION" >> $GITHUB_OUTPUT

    - name: Create and push tag
      shell: bash
      run: |
        git config user.name "github-actions"
        git config user.email "github-actions@github.com"
        git tag ${{ steps.version.outputs.version }}
        git push origin ${{ steps.version.outputs.version }}
